{
  "version": 3,
  "sources": ["../src/constant.ts", "../src/event-bus.ts", "../src/utils.ts", "../src/operation-bar.ts", "../src/video.ts", "../src/index.ts"],
  "sourcesContent": ["export const VideoExtensionsRegexp = /(?=.)(mp4|ogg|avi|webm)$/;\n\nexport const GoogleFontsIcons = `https://fonts.googleapis.com/css2?family=Material+Symbols+Outlined:opsz,wght,FILL,GRAD@24,400,0,0`;\n\nexport const DefaultWidth = 320;\nexport const DefaultHeight = 180;\n\nexport const volumeBarWidth = 60;", "type EventCallback = (payload?: any) => any;\n\nclass EventBus {\n  store: Record<string, EventCallback[]> = {};\n\n\n  on(eventName: string, fn: EventCallback) {\n    if (!fn || !(fn instanceof Function)) return;\n    if (!this.store[eventName]) {\n      this.store[eventName] = [];\n    }\n    this.store[eventName].push(fn);\n  }\n\n  emit(eventName: string, payload?: any) {\n    const fnList = this.store[eventName];\n    return fnList?.map((fn) => {\n      return fn(payload);\n    });\n  }\n\n  remove(eventName: string, fn?: EventCallback) {\n    if (!this.store[eventName]) return;\n    if (!fn) {\n      delete this.store[eventName];\n      return;\n    }\n    this.store[eventName] = this.store[eventName].filter((cb) => cb !== fn);\n  }\n}\n\nconst eventBus = new EventBus();\nexport default eventBus;", "export function createGoogleIcon(iconName: string, className: string): HTMLSpanElement {\n  const icon = document.createElement('span');\n  icon.className = `material-symbols-outlined ${className}`;\n  icon.innerText = iconName;\n  return icon;\n}\n\nexport function appendChildren(container: HTMLElement, elementList: HTMLElement[]) {\n  elementList.forEach(element => {\n    container.appendChild(element);\n  });\n}\n\nexport function createElementAndSetClassName(elementName: string, className: string) {\n  const element = document.createElement(elementName);\n  element.className = className;\n  return element;\n}", "import { GoogleFontsIcons, volumeBarWidth } from \"./constant\";\nimport eventBus from \"./event-bus\";\nimport { appendChildren, createElementAndSetClassName, createGoogleIcon } from \"./utils\";\n\nclass OperationBar {\n\n  public container: HTMLElement;\n\n  constructor() {\n    // Insert Google Fonts Icons into document\n    this.insertLink();\n    // Functions include play\\pause button, playback speed adjustment, volume adjustment, progress bar, full screen, picture in picture\n    // Create the DOM of operation bar\n    const leftGroup = createElementAndSetClassName('div', 'flex-container--row');\n    appendChildren(leftGroup, [\n      this.createPlaybackButton(),\n      this.createVolumeAdjustmentButton(),\n    ]);\n\n    const rightGroup = createElementAndSetClassName('div', 'flex-container--row');\n    appendChildren(rightGroup, [\n      this.createSpeedAdjustmentMenu(),\n      this.createPicInPicButton(),\n      this.createFullScreenButton(),\n    ]);\n\n    this.container = this.createContainer();\n    appendChildren(this.container, [\n      leftGroup,\n      this.createProgressBar(),\n      rightGroup,\n    ]);\n  }\n\n\n  private insertLink() {\n    const link = document.createElement('link');\n    link.rel = 'stylesheet';\n    link.href = GoogleFontsIcons;\n    document.head.appendChild(link);\n  }\n\n  private createContainer() {\n    const container = createElementAndSetClassName('div', 'simple-player__operation-bar');\n    return container;\n  }\n\n  private createPlaybackButton() {\n    const playBtn = createGoogleIcon('play_arrow', 'simple-player__operation-bar__play');\n    let status = false; // true - playing, false - paused\n    playBtn.onclick = () => {\n      status = eventBus.emit(status ? 'operation_pause' : 'operation_play')[0];\n      playBtn.innerText =  status ? 'pause' : 'play_arrow';\n    };\n    return playBtn; \n  }\n\n  private createVolumeAdjustmentButton() {\n    const volumeAdjustmentContainer = createElementAndSetClassName('div', 'operation-bar__volume')\n    const volumeBtn = createGoogleIcon('volume_up', 'simple-player__operation-bar__volume');\n    const volumeBar = createElementAndSetClassName('div', 'operation-bar__volume__bar');\n\n    volumeBar.addEventListener('click', (e) => {\n      const offsetX = e.offsetX;\n      const volume = offsetX / volumeBarWidth;\n      volumeBar.style.background = `linear-gradient(to right, #f0b1b1 ${volume * 100}%, #fff 0)`\n      eventBus.emit('volume_change', volume);\n    });\n    appendChildren(volumeAdjustmentContainer, [volumeBtn, volumeBar]);\n    return volumeAdjustmentContainer;\n  }\n\n  private createProgressBar() {\n    return createElementAndSetClassName('div', 'simple-player__operation-bar__progress');\n  }\n\n  private createSpeedAdjustmentMenu() {\n    const speedContainer = createElementAndSetClassName('div', 'simple-player__operation-bar__speed');\n    speedContainer.innerHTML = `\n      <span class=\"material-symbols-outlined icon-close\">\n        close\n      </span>1\n    `;\n\n    const menu = createElementAndSetClassName('div', 'operation-bar__speed__menu');\n    const menuItems = [ '2', '1.5', '1', '0.5'];\n    appendChildren(menu, menuItems.map((text) => {\n      const item = createElementAndSetClassName('div', 'speed__menu__item');\n      item.innerHTML = `\n        <span class=\"material-symbols-outlined icon-close\">\n          close\n        </span>${text}\n      `;\n      return item;\n    }));\n    speedContainer.appendChild(menu);\n\n    \n    return speedContainer;\n  }\n\n  private createFullScreenButton() {\n    return createGoogleIcon('fullscreen', 'simple-player__operation-bar__fullscreen');\n  }\n\n  private createPicInPicButton() {\n    return createGoogleIcon('picture_in_picture_alt', 'simple-player__operation-bar__pic-in-pic')\n  }\n}\n\nexport default OperationBar;", "import { VideoExtensionsRegexp } from \"./constant\";\nimport { DefaultWidth, DefaultHeight } from './constant';\nimport eventBus from './event-bus';\nclass Video {\n  rawVideo: HTMLVideoElement;\n  canvas!: HTMLCanvasElement;\n\n  private urls?: string[];\n  private ctx!: CanvasRenderingContext2D;\n\n  private width;\n  private height;\n\n  constructor(params: {\n    width?: number;\n    height?: number;\n    initialUrls?: string[];\n  }) {\n    this.width = params?.width || DefaultWidth;\n    this.height = params?.height || DefaultHeight;\n\n    this.rawVideo = document.createElement('video');\n    this.rawVideo.className = 'simple-player__raw-video';\n\n    this.urls = params.initialUrls;\n    this.createSources();\n    \n    this.initCanvas();\n    this.initEventListener();\n  }\n  \n  play(urls?: string[]) {\n    if (urls) this.urls = urls;\n    this.createSources();\n\n    if (!this.urls) throw new Error('No videos available to play');\n\n    this.rawVideo.play();\n    this.render();\n  }\n\n  pause() {\n    this.rawVideo.pause();\n  }\n\n  private createSources() {\n    if (this.urls instanceof Array && this.urls?.length) {\n      // Clean up elements left over from the last playback\n      this.rawVideo.innerHTML = '';\n      this.urls?.forEach((url) => {\n        const source = this.createSource(url);\n        if (source) this.rawVideo.appendChild(source);\n      });\n    }\n  }\n\n  private initEventListener() {\n    eventBus.on('operation_play', () => {\n      this.play();\n      return true;\n    });\n\n    eventBus.on('operation_pause', () => {\n      this.pause();\n      return false;\n    });\n\n    eventBus.on('volume_change', (volume) => {\n      this.rawVideo.volume = volume;\n      return false;\n    });\n  }\n  private initCanvas() {\n    this.canvas = document.createElement('canvas');\n    this.ctx = this.canvas.getContext('2d')!; \n\n    this.canvas.width = this.width;\n    this.canvas.height = this.height;\n  }\n\n  private createSource(url: string) {\n    const ext = url.match(VideoExtensionsRegexp)?.[0];\n    if (!ext) return;\n    // Create source element and append it to the video element\n    const source = document.createElement('source');\n    source.src = url;\n    source.type= `video/${ext}`;\n    return source;\n  }\n\n  private render() {\n    if (this.rawVideo.paused || this.rawVideo.ended) {\n      return;\n    }\n    this.ctx.drawImage(this.rawVideo, 0, 0, this.width, this.height);\n    window.requestAnimationFrame(() => {\n      this.render();\n    });\n  }\n\n}\n\nexport default Video;", "import OperationBar from \"./operation-bar\";\nimport { appendChildren } from \"./utils\";\nimport Video from \"./video\";\nimport './styles.less';\nimport { DefaultHeight, DefaultWidth } from \"./constant\";\n\ntype StyleType = {\n  width: number;\n  height: number;\n};\n\nclass Player {\n  private container!: HTMLElement;\n  private style?: StyleType;\n  private initialUrls?: string[];\n\n  private operationBar!: OperationBar;\n  public video!: Video;\n\n  constructor(params: {\n    elementId: string;\n    style?: StyleType;\n    initialUrls?: string[];\n  }) {\n    this.style = params.style;\n    this.initialUrls = params.initialUrls;\n    \n    this.initContainer(params.elementId);\n    this.initCore();\n  }\n\n  // Create UI and initialize core functions such as play, pause, fast forward, etc.\n  private initCore() {\n    this.initVideo();\n    this.initOperationBar();\n  }\n\n  private initContainer(elementId: string) {\n    const element = document.getElementById(elementId);\n    if (!element) throw new Error('Container not exist!');\n    \n    element.style.width = `${this.style?.width || DefaultWidth}px`;\n    element.style.height = `${this.style?.height || DefaultHeight}px`;\n    element.className = `${element.className} simple-player`;\n    this.container = element;\n  }\n\n  private initVideo() {\n    this.video = new Video({\n      width: this.style?.width,\n      height: this.style?.height,\n      initialUrls: this.initialUrls,\n    });\n  \n    this.container.appendChild(this.video.rawVideo);\n    this.container.appendChild(this.video.canvas);\n    appendChildren(this.container, [this.video.rawVideo, this.video.canvas]);\n  }\n\n  private initOperationBar() {\n    this.operationBar = new OperationBar();\n    this.container.appendChild(this.operationBar.container);\n  }\n}\n\nexport default Player;\n\n(window as any).SimplePlayer = Player; \n"],
  "mappings": "mBAAO,IAAMA,EAAwB,2BAExBC,EAAmB,oGCAhC,IAAMC,EAAN,KAAe,CAAf,cACE,WAAyC,CAAC,EAG1C,GAAGC,EAAmBC,EAAmB,CACnC,CAACA,GAAM,EAAEA,aAAc,YACtB,KAAK,MAAMD,CAAS,IACvB,KAAK,MAAMA,CAAS,EAAI,CAAC,GAE3B,KAAK,MAAMA,CAAS,EAAE,KAAKC,CAAE,EAC/B,CAEA,KAAKD,EAAmBE,EAAe,CACrC,IAAMC,EAAS,KAAK,MAAMH,CAAS,EACnC,OAAOG,GAAA,YAAAA,EAAQ,IAAKF,GACXA,EAAGC,CAAO,EAErB,CAEA,OAAOF,EAAmBC,EAAoB,CAC5C,GAAK,KAAK,MAAMD,CAAS,EACzB,IAAI,CAACC,EAAI,CACP,OAAO,KAAK,MAAMD,CAAS,EAC3B,MACF,CACA,KAAK,MAAMA,CAAS,EAAI,KAAK,MAAMA,CAAS,EAAE,OAAQI,GAAOA,IAAOH,CAAE,EACxE,CACF,EAEMI,EAAW,IAAIN,EACdO,EAAQD,EChCR,SAASE,EAAiBC,EAAkBC,EAAoC,CACrF,IAAMC,EAAO,SAAS,cAAc,MAAM,EAC1C,OAAAA,EAAK,UAAY,6BAA6B,OAAAD,GAC9CC,EAAK,UAAYF,EACVE,CACT,CAEO,SAASC,EAAeC,EAAwBC,EAA4B,CACjFA,EAAY,QAAQC,GAAW,CAC7BF,EAAU,YAAYE,CAAO,CAC/B,CAAC,CACH,CAEO,SAASC,EAA6BC,EAAqBP,EAAmB,CACnF,IAAMK,EAAU,SAAS,cAAcE,CAAW,EAClD,OAAAF,EAAQ,UAAYL,EACbK,CACT,CCbA,IAAMG,EAAN,KAAmB,CAIjB,aAAc,CAEZ,KAAK,WAAW,EAGhB,IAAMC,EAAYC,EAA6B,MAAO,qBAAqB,EAC3EC,EAAeF,EAAW,CACxB,KAAK,qBAAqB,EAC1B,KAAK,6BAA6B,CACpC,CAAC,EAED,IAAMG,EAAaF,EAA6B,MAAO,qBAAqB,EAC5EC,EAAeC,EAAY,CACzB,KAAK,0BAA0B,EAC/B,KAAK,qBAAqB,EAC1B,KAAK,uBAAuB,CAC9B,CAAC,EAED,KAAK,UAAY,KAAK,gBAAgB,EACtCD,EAAe,KAAK,UAAW,CAC7BF,EACA,KAAK,kBAAkB,EACvBG,CACF,CAAC,CACH,CAGQ,YAAa,CACnB,IAAMC,EAAO,SAAS,cAAc,MAAM,EAC1CA,EAAK,IAAM,aACXA,EAAK,KAAOC,EACZ,SAAS,KAAK,YAAYD,CAAI,CAChC,CAEQ,iBAAkB,CAExB,OADkBH,EAA6B,MAAO,8BAA8B,CAEtF,CAEQ,sBAAuB,CAC7B,IAAMK,EAAUC,EAAiB,aAAc,oCAAoC,EAC/EC,EAAS,GACb,OAAAF,EAAQ,QAAU,IAAM,CACtBE,EAASC,EAAS,KAAKD,EAAS,kBAAoB,gBAAgB,EAAE,CAAC,EACvEF,EAAQ,UAAaE,EAAS,QAAU,YAC1C,EACOF,CACT,CAEQ,8BAA+B,CACrC,IAAMI,EAA4BT,EAA6B,MAAO,uBAAuB,EACvFU,EAAYJ,EAAiB,YAAa,sCAAsC,EAChFK,EAAYX,EAA6B,MAAO,4BAA4B,EAElF,OAAAW,EAAU,iBAAiB,QAAUC,GAAM,CAEzC,IAAMC,EADUD,EAAE,QACO,GACzBD,EAAU,MAAM,WAAa,qCAAqC,OAAAE,EAAS,IAAG,cAC9EL,EAAS,KAAK,gBAAiBK,CAAM,CACvC,CAAC,EACDZ,EAAeQ,EAA2B,CAACC,EAAWC,CAAS,CAAC,EACzDF,CACT,CAEQ,mBAAoB,CAC1B,OAAOT,EAA6B,MAAO,wCAAwC,CACrF,CAEQ,2BAA4B,CAClC,IAAMc,EAAiBd,EAA6B,MAAO,qCAAqC,EAChGc,EAAe,UAAY,mGAM3B,IAAMC,EAAOf,EAA6B,MAAO,4BAA4B,EAE7E,OAAAC,EAAec,EADG,CAAE,IAAK,MAAO,IAAK,KAAK,EACX,IAAKC,GAAS,CAC3C,IAAMC,EAAOjB,EAA6B,MAAO,mBAAmB,EACpE,OAAAiB,EAAK,UAAY,kGAGN,OAAAD,EAAI,YAERC,CACT,CAAC,CAAC,EACFH,EAAe,YAAYC,CAAI,EAGxBD,CACT,CAEQ,wBAAyB,CAC/B,OAAOR,EAAiB,aAAc,0CAA0C,CAClF,CAEQ,sBAAuB,CAC7B,OAAOA,EAAiB,yBAA0B,0CAA0C,CAC9F,CACF,EAEOY,EAAQpB,EC3Gf,IAAMqB,EAAN,KAAY,CAUV,YAAYC,EAIT,CACD,KAAK,OAAQA,GAAA,YAAAA,EAAQ,QAAS,IAC9B,KAAK,QAASA,GAAA,YAAAA,EAAQ,SAAU,IAEhC,KAAK,SAAW,SAAS,cAAc,OAAO,EAC9C,KAAK,SAAS,UAAY,2BAE1B,KAAK,KAAOA,EAAO,YACnB,KAAK,cAAc,EAEnB,KAAK,WAAW,EAChB,KAAK,kBAAkB,CACzB,CAEA,KAAKC,EAAiB,CAIpB,GAHIA,IAAM,KAAK,KAAOA,GACtB,KAAK,cAAc,EAEf,CAAC,KAAK,KAAM,MAAM,IAAI,MAAM,6BAA6B,EAE7D,KAAK,SAAS,KAAK,EACnB,KAAK,OAAO,CACd,CAEA,OAAQ,CACN,KAAK,SAAS,MAAM,CACtB,CAEQ,eAAgB,CA7C1B,IAAAC,EAAAC,EA8CQ,KAAK,gBAAgB,SAASD,EAAA,KAAK,OAAL,MAAAA,EAAW,UAE3C,KAAK,SAAS,UAAY,IAC1BC,EAAA,KAAK,OAAL,MAAAA,EAAW,QAASC,GAAQ,CAC1B,IAAMC,EAAS,KAAK,aAAaD,CAAG,EAChCC,GAAQ,KAAK,SAAS,YAAYA,CAAM,CAC9C,GAEJ,CAEQ,mBAAoB,CAC1BC,EAAS,GAAG,iBAAkB,KAC5B,KAAK,KAAK,EACH,GACR,EAEDA,EAAS,GAAG,kBAAmB,KAC7B,KAAK,MAAM,EACJ,GACR,EAEDA,EAAS,GAAG,gBAAkBC,IAC5B,KAAK,SAAS,OAASA,EAChB,GACR,CACH,CACQ,YAAa,CACnB,KAAK,OAAS,SAAS,cAAc,QAAQ,EAC7C,KAAK,IAAM,KAAK,OAAO,WAAW,IAAI,EAEtC,KAAK,OAAO,MAAQ,KAAK,MACzB,KAAK,OAAO,OAAS,KAAK,MAC5B,CAEQ,aAAaH,EAAa,CAhFpC,IAAAF,EAiFI,IAAMM,GAAMN,EAAAE,EAAI,MAAMK,CAAqB,IAA/B,YAAAP,EAAmC,GAC/C,GAAI,CAACM,EAAK,OAEV,IAAMH,EAAS,SAAS,cAAc,QAAQ,EAC9C,OAAAA,EAAO,IAAMD,EACbC,EAAO,KAAM,SAAS,OAAAG,GACfH,CACT,CAEQ,QAAS,CACX,KAAK,SAAS,QAAU,KAAK,SAAS,QAG1C,KAAK,IAAI,UAAU,KAAK,SAAU,EAAG,EAAG,KAAK,MAAO,KAAK,MAAM,EAC/D,OAAO,sBAAsB,IAAM,CACjC,KAAK,OAAO,CACd,CAAC,EACH,CAEF,EAEOK,EAAQX,EC3Ff,IAAMY,EAAN,KAAa,CAQX,YAAYC,EAIT,CACD,KAAK,MAAQA,EAAO,MACpB,KAAK,YAAcA,EAAO,YAE1B,KAAK,cAAcA,EAAO,SAAS,EACnC,KAAK,SAAS,CAChB,CAGQ,UAAW,CACjB,KAAK,UAAU,EACf,KAAK,iBAAiB,CACxB,CAEQ,cAAcC,EAAmB,CArC3C,IAAAC,EAAAC,EAsCI,IAAMC,EAAU,SAAS,eAAeH,CAAS,EACjD,GAAI,CAACG,EAAS,MAAM,IAAI,MAAM,sBAAsB,EAEpDA,EAAQ,MAAM,MAAQ,GAAG,SAAAF,EAAA,KAAK,QAAL,YAAAA,EAAY,QAAS,IAAY,MAC1DE,EAAQ,MAAM,OAAS,GAAG,SAAAD,EAAA,KAAK,QAAL,YAAAA,EAAY,SAAU,IAAa,MAC7DC,EAAQ,UAAY,GAAG,OAAAA,EAAQ,UAAS,kBACxC,KAAK,UAAYA,CACnB,CAEQ,WAAY,CA/CtB,IAAAF,EAAAC,EAgDI,KAAK,MAAQ,IAAIE,EAAM,CACrB,OAAOH,EAAA,KAAK,QAAL,YAAAA,EAAY,MACnB,QAAQC,EAAA,KAAK,QAAL,YAAAA,EAAY,OACpB,YAAa,KAAK,WACpB,CAAC,EAED,KAAK,UAAU,YAAY,KAAK,MAAM,QAAQ,EAC9C,KAAK,UAAU,YAAY,KAAK,MAAM,MAAM,EAC5CG,EAAe,KAAK,UAAW,CAAC,KAAK,MAAM,SAAU,KAAK,MAAM,MAAM,CAAC,CACzE,CAEQ,kBAAmB,CACzB,KAAK,aAAe,IAAIC,EACxB,KAAK,UAAU,YAAY,KAAK,aAAa,SAAS,CACxD,CACF,EAEOC,EAAQT,EAEd,OAAe,aAAeA",
  "names": ["VideoExtensionsRegexp", "GoogleFontsIcons", "EventBus", "eventName", "fn", "payload", "fnList", "cb", "eventBus", "event_bus_default", "createGoogleIcon", "iconName", "className", "icon", "appendChildren", "container", "elementList", "element", "createElementAndSetClassName", "elementName", "OperationBar", "leftGroup", "createElementAndSetClassName", "appendChildren", "rightGroup", "link", "GoogleFontsIcons", "playBtn", "createGoogleIcon", "status", "event_bus_default", "volumeAdjustmentContainer", "volumeBtn", "volumeBar", "e", "volume", "speedContainer", "menu", "text", "item", "operation_bar_default", "Video", "params", "urls", "_a", "_b", "url", "source", "event_bus_default", "volume", "ext", "VideoExtensionsRegexp", "video_default", "Player", "params", "elementId", "_a", "_b", "element", "video_default", "appendChildren", "operation_bar_default", "src_default"]
}
