"use strict";(()=>{var v=/(?=.)(mp4|ogg|avi|webm)$/,y="https://fonts.googleapis.com/css2?family=Material+Symbols+Outlined:opsz,wght,FILL,GRAD@24,400,0,0";var m=class{constructor(){this.store={}}on(e,t){!t||!(t instanceof Function)||(this.store[e]||(this.store[e]=[]),this.store[e].push(t))}emit(e,t){let i=this.store[e];return i==null?void 0:i.map(n=>n(t))}remove(e,t){if(this.store[e]){if(!t){delete this.store[e];return}this.store[e]=this.store[e].filter(i=>i!==t)}}},w=new m,r=w;function c(s,e){let t=document.createElement("span");return t.className="material-symbols-outlined ".concat(e),t.innerText=s,t}function p(s,e){e.forEach(t=>{s.appendChild(t)})}function o(s,e){let t=document.createElement(s);return t.className=e,t}var _=class{constructor(){this.insertLink();let e=o("div","flex-container--row");p(e,[this.createPlaybackButton(),this.createVolumeAdjustmentButton()]);let t=o("div","flex-container--row");p(t,[this.createSpeedAdjustmentMenu(),this.createPicInPicButton(),this.createFullScreenButton()]),this.container=this.createContainer(),p(this.container,[e,this.createProgressBar(),t])}insertLink(){let e=document.createElement("link");e.rel="stylesheet",e.href=y,document.head.appendChild(e)}createContainer(){return o("div","simple-player__operation-bar")}createPlaybackButton(){let e=c("play_arrow","simple-player__operation-bar__play"),t=!1;return e.onclick=()=>{t=r.emit(t?"_operation_pause":"_operation_play")[0],e.innerText=t?"pause":"play_arrow"},r.on("_video_ended",()=>{t=!1,e.innerText="play_arrow"}),e}createVolumeAdjustmentButton(){let e=o("div","operation-bar__volume"),t=c("volume_up","simple-player__operation-bar__volume"),i=o("div","operation-bar__volume__bar"),n=d=>{i.style.background="linear-gradient(to right, #f0b1b1 ".concat(d*100,"%, #fff 0)"),r.emit("_volume_change",d)},a=1;i.addEventListener("click",d=>{a=d.offsetX/60,n(a),t.innerText=a?"volume_up":"volume_off"});let l=!1;return t.onclick=()=>{t.innerText=l?"volume_up":"volume_off",n(l?a:0),l=!l},p(e,[t,i]),e}createProgressBar(){let e=o("div","simple-player__operation-bar__progress"),t=0;return r.on("_duration_change",i=>t=i),r.on("_time_update",i=>{e.style.background="linear-gradient(to right, #f0b1b1 ".concat(i/t*100,"%, #fff 0)")}),e.onclick=i=>{let a=i.offsetX/i.target.offsetWidth;r.emit("_seek",a)},e}createSpeedAdjustmentMenu(){let e=o("div","simple-player__operation-bar__speed"),t=o("span","operation-bar__speed__value");e.innerHTML='\n      <span class="material-symbols-outlined icon-close">\n        close\n      </span>\n    ',t.innerText="1",e.append(t);let i=o("div","operation-bar__speed__menu");return p(i,["2","1.5","1","0.5"].map(a=>{let l=o("div","speed__menu__item");return l.innerHTML='\n        <span class="material-symbols-outlined icon-close">\n          close\n        </span>'.concat(a,"\n      "),l.onclick=()=>{t.innerText=a,r.emit("_speed_adjust",+a)},l})),e.appendChild(i),e}createFullScreenButton(){let e=c("fullscreen","simple-player__operation-bar__fullscreen"),t=!1;return e.onclick=()=>{t=!t,r.emit("_fullscreen",t)},e}createPicInPicButton(){let e=c("picture_in_picture_alt","simple-player__operation-bar__pic-in-pic"),t=!1;return e.onclick=()=>{t=!t,r.emit("_pic-in-pic",t)},e}},g=_;var f=class{constructor(e){this.width=(e==null?void 0:e.width)||320,this.height=(e==null?void 0:e.height)||320*9/16,this.rawVideo=document.createElement("video"),this.rawVideo.className="simple-player__raw-video",this.urls=e.initialUrls,this.createSources(),this.initCanvas(),this.initEventListener()}play(e){if(e&&(this.urls=e),this.createSources(),!this.urls)throw new Error("No videos available to play");this.rawVideo.play(),this.render()}pause(){this.rawVideo.pause()}createSources(){var e,t;this.urls instanceof Array&&((e=this.urls)!=null&&e.length)&&(this.rawVideo.innerHTML="",(t=this.urls)==null||t.forEach(i=>{let n=this.createSource(i);n&&this.rawVideo.appendChild(n)}))}initEventListener(){r.on("_operation_play",()=>(this.play(),!0)),r.on("_operation_pause",()=>(this.pause(),!1)),r.on("_volume_change",e=>(this.rawVideo.volume=e,!1)),r.on("_seek",e=>{let i=this.rawVideo.duration*e;this.rawVideo.currentTime=i}),r.on("_speed_adjust",e=>{this.rawVideo.playbackRate=e}),r.on("_pic-in-pic",e=>{e?this.rawVideo.requestPictureInPicture():document.exitPictureInPicture()}),this.rawVideo.ondurationchange=()=>{r.emit("_duration_change",this.rawVideo.duration)},this.rawVideo.ontimeupdate=e=>{r.emit("_time_update",this.rawVideo.currentTime)},this.rawVideo.onended=()=>{r.emit("_video_ended")}}initCanvas(){this.canvas=document.createElement("canvas"),this.ctx=this.canvas.getContext("2d"),this.canvas.width=this.width,this.canvas.height=this.height}createSource(e){var n;let t=(n=e.match(v))==null?void 0:n[0];if(!t)return;let i=document.createElement("source");return i.src=e,i.type="video/".concat(t),i}render(){this.rawVideo.paused||this.rawVideo.ended||(this.ctx.drawImage(this.rawVideo,0,0,this.width,this.height),window.requestAnimationFrame(()=>{this.render()}))}},b=f;var h=class{constructor(e){this.style=e.style,this.initialUrls=e.initialUrls,this.initContainer(e.elementId),this.initCore(),this.initEventListeners()}initCore(){this.initVideo(),this.initOperationBar()}initContainer(e){var i,n;let t=document.getElementById(e);if(!t)throw new Error("Container not exist!");t.style.width="".concat(((i=this.style)==null?void 0:i.width)||320,"px"),t.style.height="".concat(((n=this.style)==null?void 0:n.height)||208,"px"),t.className="".concat(t.className," simple-player"),this.container=t}initVideo(){var e,t;this.video=new b({width:(e=this.style)==null?void 0:e.width,height:(t=this.style)==null?void 0:t.height,initialUrls:this.initialUrls}),this.container.appendChild(this.video.rawVideo),this.container.appendChild(this.video.canvas),p(this.container,[this.video.rawVideo,this.video.canvas])}initOperationBar(){this.operationBar=new g,this.container.appendChild(this.operationBar.container)}initEventListeners(){r.on("_fullscreen",e=>{e?(this.container.requestFullscreen(),this.container.className+=" simple-player--fullscreen"):(document.exitFullscreen(),this.container.className=this.container.className.replace(" simple-player--fullscreen",""))})}},X=h;window.SimplePlayer=h;})();
//# sourceMappingURL=index.js.map
